<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Numeric Duel - Browser Game</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <!-- Menu Screen -->
        <div id="menu-screen" class="screen active">
            <div class="menu-content">

                <h1 class="game-title">–ß–∏—Å–ª–æ–≤–∞—è –¥—É—ç–ª—å</h1>

                <div class="nickname-input-container">
                    <input type="text" id="nickname-input" class="nickname-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–∏–∫–Ω–µ–π–º"
                        maxlength="20">
                    <div id="nickname-status" class="nickname-status"></div>
                </div>

                <div class="menu-buttons">
                    <button class="btn btn-primary" id="start-btn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É (vs AI)</button>
                    <button class="btn btn-primary" id="multiplayer-btn">–ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä</button>
                    <button class="btn btn-secondary" id="leaderboard-btn">–õ–∏–¥–µ—Ä–±–æ—Ä–¥</button>
                    <button class="btn btn-secondary" id="rules-btn">–ü—Ä–∞–≤–∏–ª–∞</button>
                </div>

                <div class="mini-leaderboard">
                    <h3 style="margin: 20px 0 10px; color: var(--warning-color);">üèÜ –¢–û–ü –ò–ì–†–û–ö–û–í</h3>
                    <div id="mini-leaderboard-list" class="mini-leaderboard-list">
                        <!-- Top players will be added via JS -->
                    </div>
                </div>

                <!-- Chat -->
                <div class="chat-container">
                    <div class="chat-header">
                        <h3 id="chat-title">üí¨ –ì–ª–æ–±–∞–ª—å–Ω—ã–π —á–∞—Ç</h3>
                        <button class="btn-chat-toggle" id="chat-toggle">‚àí</button>
                    </div>
                    <div class="chat-messages" id="chat-messages">
                        <div class="chat-message system" id="chat-welcome">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ ¬´–ß–∏—Å–ª–æ–≤—É—é –¥—É—ç–ª—å¬ª! –û–±—â–∞–π—Ç–µ—Å—å —Å –¥—Ä—É–≥–∏–º–∏ –∏–≥—Ä–æ–∫–∞–º–∏.</div>
                    </div>
                    <div class="chat-input-container">
                        <input type="text" id="chat-input" class="chat-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
                            maxlength="200">
                        <button class="btn btn-primary btn-send" id="chat-send">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Selection Screen -->
        <div id="selection-screen" class="screen">
            <div class="selection-content">
                <h2>–í—ã–±–µ—Ä–∏—Ç–µ –≤–æ–π—Å–∫–∞</h2>
                <p class="hint">–í—ã–±–µ—Ä–∏—Ç–µ —á–∏—Å–ª–∞ –¥–ª—è –≤–∞—à–µ–π –∞—Ä–º–∏–∏. –ö–∞–∂–¥–æ–µ —á–∏—Å–ª–æ ‚Äî —ç—Ç–æ –æ—Ç—Ä—è–¥ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞</p>

                <div class="number-grid" id="number-grid">
                    <!-- Numbers will be added via JS -->
                </div>

                <div class="selected-display">
                    <h3>–í–∞—à–∞ –∞—Ä–º–∏—è:</h3>
                    <div class="selected-numbers" id="selected-numbers"></div>
                    <p class="hint-small">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —á–∏—Å–ª–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ, —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å –µ–≥–æ</p>
                </div>

                <button class="btn btn-primary" id="ready-btn" disabled>–í –±–æ–π!</button>
            </div>
        </div>

        <!-- Flank Setup Screen -->
        <div id="flank-setup-screen" class="screen">
            <div class="flank-content">
                <h2 id="round-title">–•–æ–¥ 1</h2>
                <p class="hint">–†–∞—Å—Å—Ç–∞–≤—å—Ç–µ –≤–æ–π—Å–∫–∞ –Ω–∞ —Ñ–ª–∞–Ω–≥–∏</p>

                <div class="flank-battlefield">
                    <!-- Your flanks -->
                    <div class="flank-player" id="your-flanks">
                        <h3><span id="your-nickname-display" class="player-nickname">–í–∞—à–∏ –≤–æ–π—Å–∫–∞</span></h3>

                        <div class="flank-slots">
                            <div class="flank-slot flank-left">
                                <div class="flank-label">–õ–µ–≤—ã–π</div>
                                <!-- Unit will appear here -->
                            </div>
                            <div class="flank-slot flank-center">
                                <div class="flank-label">–¶–µ–Ω—Ç—Ä</div>
                            </div>
                            <div class="flank-slot flank-right">
                                <div class="flank-label">–ü—Ä–∞–≤—ã–π</div>
                            </div>
                        </div>

                        <div class="available-numbers">
                            <!-- Available units -->
                        </div>

                        <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px;">
                            <button class="btn btn-primary start-battle-btn" id="flank-ready-btn">–ù–∞—á–∞—Ç—å –±–æ–π!</button>
                            <button class="btn btn-danger surrender-btn" id="surrender-btn">üè≥Ô∏è –°–¥–∞—Ç—å—Å—è</button>
                        </div>
                    </div>

                    <!-- Enemy flanks -->
                    <div class="flank-player" id="enemy-flanks">
                        <h3><span id="enemy-nickname-display" class="player-nickname">–í—Ä–∞–≥</span></h3>

                        <div class="flank-slots">
                            <div class="flank-slot flank-left">
                                <div class="flank-label">–õ–µ–≤—ã–π</div>
                            </div>
                            <div class="flank-slot flank-center">
                                <div class="flank-label">–¶–µ–Ω—Ç—Ä</div>
                            </div>
                            <div class="flank-slot flank-right">
                                <div class="flank-label">–ü—Ä–∞–≤—ã–π</div>
                            </div>
                        </div>

                        <div class="available-numbers">
                            <!-- Enemy available units (hidden) -->
                        </div>
                    </div>
                </div>

                <!-- Advantages reminder -->
                <div class="advantages-reminder">
                    <div class="advantage-item">
                        <span class="advantage-icon">‚öîÔ∏è</span>
                        <span class="advantage-arrow">‚Üí</span>
                        <span class="advantage-icon">üê¥</span>
                    </div>
                    <div class="advantage-item">
                        <span class="advantage-icon">üèπ</span>
                        <span class="advantage-arrow">‚Üí</span>
                        <span class="advantage-icon">‚öîÔ∏è</span>
                    </div>
                    <div class="advantage-item">
                        <span class="advantage-icon">üê¥</span>
                        <span class="advantage-arrow">‚Üí</span>
                        <span class="advantage-icon">üèπ</span>
                    </div>
                </div>

                <div class="battle-log" id="battle-log">
                    <div class="log-entry" id="battle-log-initial">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –±–æ—é...</div>
                </div>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="screen">
            <div class="result-content">
                <div class="result-icon" id="result-icon">üèÜ</div>
                <h2 id="result-title">–ü–æ–±–µ–¥–∞!</h2>
                <p id="result-message">–í—ã –ø–æ–±–µ–¥–∏–ª–∏ –≤ —ç—Ç–æ–π –¥—É—ç–ª–∏</p>
                <div class="result-buttons">
                    <button class="btn btn-primary" id="play-again-btn">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                    <button class="btn btn-secondary" id="menu-btn">–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
                </div>
            </div>
        </div>

        <!-- Leaderboard Screen -->
        <div id="leaderboard-screen" class="screen">
            <div class="menu-content">
                <h1 class="game-title">üèÜ –õ–ò–î–ï–†–ë–û–†–î</h1>

                <div id="player-position" class="player-position">
                    <!-- Player's position will be added via JS -->
                </div>

                <div id="leaderboard-content" class="leaderboard-content">
                    <div class="leaderboard-header">
                        <span class="rank-header">#</span>
                        <span class="name-header">–ù–∏–∫–Ω–µ–π–º</span>
                        <span class="stats-header">–†–µ–π—Ç–∏–Ω–≥</span>
                        <span class="stats-header">–ü–æ–±–µ–¥</span>
                        <span class="stats-header">–ü–æ—Ä–∞–∂–µ–Ω–∏–π</span>
                    </div>
                    <div id="leaderboard-list" class="leaderboard-list">
                        <!-- Leaders will be added via JS -->
                    </div>
                </div>
                <button class="btn btn-secondary" id="leaderboard-back-btn">–ù–∞–∑–∞–¥</button>
            </div>
        </div>

        <!-- Multiplayer Screen (Lobby) -->
        <div id="multiplayer-screen" class="screen">
            <div class="menu-content">
                <h1 class="game-title">üåê –ú–£–õ–¨–¢–ò–ü–õ–ï–ï–†</h1>
                <div id="lobby-status" class="lobby-status">
                    <p>–ù–∞–∂–º–∏—Ç–µ ¬´–ù–∞–π—Ç–∏ –∏–≥—Ä—É¬ª, —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –ø–æ–¥–æ–±—Ä–∞—Ç—å —Å–æ–ø–µ—Ä–Ω–∏–∫–∞</p>
                </div>
                <div id="room-info" class="room-info" style="display: none;">
                    <h3><span id="room-label">–ö–æ–º–Ω–∞—Ç–∞:</span> <span id="room-id-display"></span></h3>
                    <p><span id="players-label">–ò–≥—Ä–æ–∫–∏:</span> <span id="players-count">1</span>/2</p>
                </div>
                <button class="btn btn-primary" id="find-match-btn">–ù–∞–π—Ç–∏ –∏–≥—Ä—É</button>
                <button class="btn btn-secondary" id="back-to-menu-btn">–ù–∞–∑–∞–¥</button>
            </div>
        </div>


        <!-- Rules Modal -->
        <div id="rules-modal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>–ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã</h2>
                <div class="rules-content">
                    <h3>–¶–µ–ª—å</h3>
                    <p>–£–Ω–∏—á—Ç–æ–∂—å—Ç–µ –≤—Å–µ –≤–æ–π—Å–∫–∞ –≤—Ä–∞–≥–∞!</p>

                    <h3>–¢–∏–ø—ã –≤–æ–π—Å–∫</h3>
                    <ul class="rules-list">
                        <li id="rule-warrior"><strong>‚öîÔ∏è –í–æ–∏–Ω—ã</strong> ‚Äî —Å–∏–ª—å–Ω—ã –ø—Ä–æ—Ç–∏–≤ üê¥ –ö–æ–Ω–Ω–∏—Ü—ã</li>
                        <li id="rule-archer"><strong>üèπ –õ—É—á–Ω–∏–∫–∏</strong> ‚Äî —Å–∏–ª—å–Ω—ã –ø—Ä–æ—Ç–∏–≤ ‚öîÔ∏è –í–æ–∏–Ω–æ–≤</li>
                        <li id="rule-cavalry"><strong>üê¥ –ö–æ–Ω–Ω–∏—Ü–∞</strong> ‚Äî —Å–∏–ª—å–Ω–∞ –ø—Ä–æ—Ç–∏–≤ üèπ –õ—É—á–Ω–∏–∫–æ–≤</li>
                    </ul>

                    <h3>–ú–µ—Ö–∞–Ω–∏–∫–∞ –±–æ—è</h3>
                    <ul class="rules-list">
                        <li id="rule-number">–ß–∏—Å–ª–æ = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—Ä–æ—Å–∫–æ–≤ –∫—É–±–∏–∫–∞ (0 –¥–æ 1)</li>
                        <li id="rule-damage">–°—É–º–º–∞ –≤—Å–µ—Ö –±—Ä–æ—Å–∫–æ–≤ = —É—Ä–æ–Ω</li>
                        <li id="rule-advantage"><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:</strong> —É—Ä–æ–Ω √ó 1.5</li>
                        <li id="rule-equal"><strong>–†–∞–≤–µ–Ω—Å—Ç–≤–æ:</strong> —É—Ä–æ–Ω √ó 1.0</li>
                        <li id="rule-weakness"><strong>–°–ª–∞–±–æ—Å—Ç—å:</strong> —É—Ä–æ–Ω √ó 0.5</li>
                        <li id="rule-after">–ü–æ—Å–ª–µ –±–æ—è –≤—ã—á—Ç–∏—Ç–µ —É—Ä–æ–Ω –∏–∑ —á–∏—Å–ª–∞</li>
                        <li id="rule-zero">–ß–∏—Å–ª–æ = 0? –û—Ç—Ä—è–¥ —É–Ω–∏—á—Ç–æ–∂–µ–Ω!</li>
                    </ul>

                    <h3>–§–ª–∞–Ω–≥–∏</h3>
                    <p id="rule-flanks">–õ–µ–≤—ã–π —Ñ–ª–∞–Ω–≥ –±—å—ë—Ç –ø–æ –ª–µ–≤–æ–º—É –≤—Ä–∞–≥–∞, —Ü–µ–Ω—Ç—Ä –ø–æ —Ü–µ–Ω—Ç—Ä—É, –ø—Ä–∞–≤—ã–π –ø–æ –ø—Ä–∞–≤–æ–º—É.</p>

                    <h3>–ü–æ–±–µ–¥–∞</h3>
                    <p id="rule-victory">–ü–æ–±–µ–∂–¥–∞–µ—Ç —Ç–æ—Ç, –∫—Ç–æ —É–Ω–∏—á—Ç–æ–∂–∏–ª –≤—Å–µ –æ—Ç—Ä—è–¥—ã –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞!</p>
                </div>
            </div>
        </div>

        <!-- System Dialog Modal -->
        <div id="system-modal" class="modal">
            <div class="modal-content dialog">
                <h2 id="system-modal-title" class="dialog-title">–°–æ–æ–±—â–µ–Ω–∏–µ</h2>
                <p id="system-modal-message" class="dialog-message">–°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</p>
                <div class="dialog-actions">
                    <button class="btn btn-secondary" id="system-modal-cancel">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-primary" id="system-modal-confirm">–•–æ—Ä–æ—à–æ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Yandex Games SDK -->
    <script src="/sdk.js" defer></script>
    <!-- Socket.io: —É–º–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –Ø–Ω–¥–µ–∫—Å –ò–≥—Ä–∞–º–∏ -->
    <script>
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∏–ª–∏ –Ø–Ω–¥–µ–∫—Å –¥–æ–º–µ–Ω (–±–µ–∑ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π)
        (function () {
            var isYandex = window.location.hostname.includes('yandex') ||
                window.location.hostname.includes('games') ||
                typeof YaGames !== 'undefined';

            var socketScript = document.createElement('script');
            if (isYandex) {
                // –Ø–Ω–¥–µ–∫—Å –ò–≥—Ä—ã - –ª–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–ø–∏—è (–∏–∑ ZIP)
                socketScript.src = 'socket.io.min.js';
            } else {
                // Vercel/–¥—Ä—É–≥–∏–µ - CDN
                socketScript.src = 'https://cdn.socket.io/4.5.4/socket.io.min.js';
            }
            document.head.appendChild(socketScript);
        })();
    </script>
    <script src="i18n.js"></script>
    <script src="game.js"></script>
</body>

</html>